---
title: "Pedagogy"
author: "Joshua Cabrera"
date: "2024-02-14"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(tidyverse)
library(caret)
library(GGally) #pairs plot
library(car) #added variable plots
library(MASS) #standardized Residuals
library(lmtest) #bp test
library(multcomp) #generalized linear hypothesis test
library(nlme)
library(tidyverse)
data <- read_delim('ClassAssessment.txt')
```


```{r }
data
data_copy <- data

ggplot(data = data, mapping = aes(x = Exam1, y = Final)) +
  geom_point()+
  # geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Exam1 by Final",
       x = "Exam1",
       y = "Final")


ggplot(data = data, mapping = aes(x = Exam2, y = Final)) +
  geom_point()+
  # geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Exam2 by Final",
       x = "Exam2",
       y = "Final")

ggplot(data = data, mapping = aes(x = Exam3, y = Final)) +
  geom_point()+
  # geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Exam3 by Final",
       x = "Exam3",
       y = "Final")

ggplot(data = data, mapping = aes(x = HW, y = Final)) +
  geom_point()+
  # geom_smooth( se = FALSE)+
  labs(title = "Boxplot of HW by Final",
       x = "HW",
       y = "Final")

ggplot(data = data, mapping = aes(x = Quiz, y = Final)) +
  geom_point()+
  # geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Quiz by Final",
       x = "Quiz",
       y = "Final")


ggplot(data = data, mapping = aes(x = NStudents, y = Final)) +
  geom_point()+
  # geom_smooth( se = FALSE)+
  labs(title = "Boxplot of NStudents by Final",
       x = "NStudents",
       y = "Final")


ggplot(data, aes(x = Semester, y = Final, fill = Semester)) +
  geom_boxplot() +
  labs(x = "Semester", y = "Final", title = "Box Plot Example") +
  theme_minimal()
```

```{r}
data$id <- 1:30

data_long <- data %>%
  pivot_longer(
    cols = c(Exam1, Exam2, Exam3, Final) )

head(data_long)
ggplot(data_long, aes(x = name, y = value, group = id, colour = id))+
  geom_point()+
  geom_line()
```


```{r}
# summary(data)

#Checking if our model should use NStudents
Pedagogy_lm <- lm(Final ~ ., data = data)
Pedagogy_lm_reduced <- lm(Final ~ Exam1+Exam2+Exam3+HW+Quiz, data = data)

summary(Pedagogy_lm)

anova(Pedagogy_lm_reduced,Pedagogy_lm)

data_copy$fittedVals <- Pedagogy_lm$fitted.values
data_copy$Residuals <- Pedagogy_lm$residuals

write.csv(data_copy, file = "ClassAssessment_copy.txt", row.names =T)


anova_result <- aov(lm(Final ~ Semester, data = data))
anova_result
summary(anova_result)

# anova_result <- anova(lm(value ~ group, data = df))

```




```{r}
plot(data$Exam1, data$Final, type = "p", pch = 16, col = "blue", xlab = "X", ylab = "Y", main = "Scatter Plot with Line")

# Add a line
abline( lm(Final ~ Exam1, data = data), col = "red")
```
# Section 3: Assumptions

### Linear
```{r, message = FALSE, out.width= "70%"}
library(car)
avPlots(Pedagogy_lm)
```
* Looking at quantitative variables- approximately linear

### Independent

### Normal
```{r, message = FALSE, out.width= "50%"}
standard <- resid(object=Pedagogy_gls, type="pearson")
ggplot()+geom_histogram(mapping=aes(x=standard))
```

- It does appear approximately normal - ish




# GLS model
```{r}
Pedagogy_gls <- gls(model= Final ~. , data= data, weights=varExp(form=~ .), method="ML")
summary(Pedagogy_gls)
```





