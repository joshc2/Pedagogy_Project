---
title: "Pedagogy"
author: "Joshua Cabrera"
date: "2024-02-14"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(tidyverse)
library(caret)
library(GGally) #pairs plot
library(car) #added variable plots
library(MASS) #standardized Residuals
library(lmtest) #bp test
library(multcomp) #generalized linear hypothesis test
library(nlme)
library(tidyverse)
data <- read_delim('ClassAssessment.txt')
```


```{r }
data
data_copy <- data

ggplot(data = data, mapping = aes(x = Exam1, y = Final)) +
  geom_point()+
  geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Exam1 by Final",
       x = "Exam1",
       y = "Final")


ggplot(data = data, mapping = aes(x = Exam2, y = Final)) +
  geom_point()+
  geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Exam2 by Final",
       x = "Exam2",
       y = "Final")

ggplot(data = data, mapping = aes(x = Exam3, y = Final)) +
  geom_point()+
  geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Exam3 by Final",
       x = "Exam3",
       y = "Final")

ggplot(data = data, mapping = aes(x = HW, y = Final)) +
  geom_point()+
  geom_smooth( se = FALSE)+
  labs(title = "Boxplot of HW by Final",
       x = "HW",
       y = "Final")

ggplot(data = data, mapping = aes(x = Quiz, y = Final)) +
  geom_point()+
  geom_smooth( se = FALSE)+
  labs(title = "Boxplot of Quiz by Final",
       x = "Quiz",
       y = "Final")


ggplot(data = data, mapping = aes(x = NStudents, y = Final)) +
  geom_point()+
  geom_smooth( se = FALSE)+
  labs(title = "Boxplot of NStudents by Final",
       x = "NStudents",
       y = "Final")
```


```{r}
summary(data)
#Checking if our model should use NStudents
Pedagogy_lm <- lm(Final ~ ., data = data)
Pedagogy_lm_reduced <- lm(Final ~ Exam1+Exam2+Exam3+HW+Quiz, data = data)

summary(Pedagogy_lm)

anova(Pedagogy_lm_reduced,Pedagogy_lm)

data_copy$fittedVals <- Pedagogy_lm$fitted.values
data_copy$Residuals <- Pedagogy_lm$residuals

write.csv(data_copy, file = "ClassAssessment_copy.txt", row.names =T)



```



```{r}
x <- 1:10
y <- c(3, 5, 6, 7, 9, 10, 11, 13, 14, 15)

# Plot the points
plot(x, y, type = "p", pch = 16, col = "blue", xlab = "X", ylab = "Y", main = "Scatter Plot with Line")

# Add a line
abline(lm(y ~ x), col = "red")
```

